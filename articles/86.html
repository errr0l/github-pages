<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>我写的脚本竟被官方针对了？！ - 小埃的个人博客</title>
    <link rel="stylesheet" href="../css/reset.css">
    <link rel="stylesheet" href="../css/base.css">
    <link rel="stylesheet" href="../css/index.css">
    <link rel="stylesheet" href="../css/header.css">
    <link rel="stylesheet" href="../css/mobile.css">
    <link rel="stylesheet" href="../css/theme-light.css">
    <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon">
    <script>
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?d1fc0144cbb354a3f8442b7ba568bc2f";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();

        window.addEventListener('DOMContentLoaded', () => {
            let headerEle = document.getElementById('header');
            let eleHeight = headerEle.offsetHeight;
            let lastScrollTop = 0;
            let topAnchor = 0; // 某个方向的锚点
            let downAnchor = 0;
            let stylTop = "-" + eleHeight + "px";
            let stylTop2 = "0";
            let threshold = 180;
            function headerEleVisibleHandler() {
                let scrollTop = document.documentElement.scrollTop;
                // 向下滚动
                if (scrollTop > lastScrollTop) {
                    if (downAnchor !== 0) {
                        downAnchor = 0;
                    }
                    if (topAnchor === 0) {
                        topAnchor = scrollTop;
                    }
                    if ((scrollTop > threshold || scrollTop - topAnchor > threshold) && headerEle.style.top !== stylTop) {
                        headerEle.style.top =  stylTop;
                    }
                }
                // 向上
                else {
                    if (topAnchor !== 0) {
                        topAnchor = 0;
                    }
                    if (downAnchor === 0) {
                        downAnchor = scrollTop;
                    }
                    if ((scrollTop + threshold > downAnchor) && headerEle.style.top === stylTop) {
                        headerEle.style.top = stylTop2;
                    }
                }
                lastScrollTop = scrollTop;
            }

            function throttleWrapper(fn, options) {
                if (!options) {
                    options = {};
                }
                let timer = null;
                const { timeout } = options;

                const _setTimeout = () => {
                    timer = window.setTimeout(() => {
                        window.clearTimeout(timer);
                        timer = null;
                    }, timeout);
                    return timer;
                }

                return function (...args) {
                    if (timer) {
                        return;
                    }
                    timer = -1;
                    let result = fn.apply(this, args);
                    _setTimeout();
                    return result;
                }
            }
            headerEleVisibleHandler = throttleWrapper(headerEleVisibleHandler, { timeout: 200 });
            window.addEventListener("scroll", headerEleVisibleHandler);
        });
    </script>
        <meta name="keywords" content="油猴脚本,js,逆向">
        <meta name="description" content="我写的脚本竟被官方针对了？！；前段时间，为某网站写了个油猴脚本，并发布到Greasy Fork上... 主要是因为网站的广告特别恶心，满屏广告不说，想下载个东西的时候，点击了，不仅没能打开正确的链接，还总是跳出新的广告，并且是个不断循环的过程，用户压根...">
    <link rel="stylesheet" href="../css/article.css">
    <link rel="stylesheet" href="../css/markdown/github-markdown.css">
    <link rel="stylesheet" href="../css/markdown/github-markdown-light.css">
    <link rel="stylesheet" href="../css/gittalk-cover.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/viewerjs/1.11.7/viewer.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/default.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
</head>
<body>
<div id="app">
    <div id="header">
    <div id="bar">
        <div class="container mg-0-auto d-f pos-r">
            <div class="logo">
                <a href="../" class="nav-link" style="margin-right: 10px;">
                    <img src="../image/portal/logo.jpg" alt="小埃的个人博客">
                </a>
            </div>
            <div class="right">
                <ul class="nav f-l">
                        <li class="nav-item">
                            <a href="../index.html" class="nav-link active">
                                <span>首页</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="../category.html" class="nav-link ">
                                <span>分类</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="../about.html" class="nav-link ">
                                <span>关于</span>
                            </a>
                        </li>
                </ul>
                <div class="eb-title">
                    小埃的个人博客
                </div>
                    <div id="search">
                        <input type="text" id="search-input" data-prefix="../" placeholder="搜索" autocomplete="off" />
                        <span class="search-icon t-a">
                            <img class="el-icon-search" src="../image/portal/search.png" width="16" height="16">
                        </span>
                        <div id="search-result">
                            <input type="text" class="input-1" id="search-input-2" data-prefix="../" placeholder="请输入" autocomplete="off" />
                            <div class="content">
                            </div>
                            <div class="arrow"></div>
                        </div>
                    </div>

                <div class="eb-menu">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-list-ul" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M5 11.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm-3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/>
                    </svg>
                </div>
            </div>
            <div id="sc-box">
                <div class="wrapper">
                        <div class="side-card b-s-1 mg-b-10">
                            <div class="wrapper">
                                <h2 class="item title">
                                    <span>相关文章</span>
                                </h2>
                                <div class="item content">
                                        <div class="item1 ">
                                            <a href="../articles/80.html">
                                                    【猿人学】jsvmp洞察先机逆向
                                            </a>
                                        </div>
                                        <div class="item1 ">
                                            <a href="../articles/77.html">
                                                    【推特】Webpack逆向
                                            </a>
                                        </div>
                                        <div class="item1 ">
                                            <a href="../articles/85.html">
                                                    剖析0.1+0.2不等于0.3的原因
                                            </a>
                                        </div>
                                        <div class="item1 ">
                                            <a href="../articles/76.html">
                                                    js实现监听单页面应用url的办法
                                            </a>
                                        </div>
                                        <div class="item1 ">
                                            <a href="../articles/72.html">
                                                    【某易云逆向】模拟登录篇
                                            </a>
                                        </div>
                                        <div class="item1 ">
                                            <a href="../articles/70.html">
                                                    为静态站点添加目录功能
                                            </a>
                                        </div>
                                        <div class="item1 ">
                                            <a href="../articles/69.html">
                                                    【某易云逆向】滑动验证码校验篇
                                            </a>
                                        </div>
                                        <div class="item1 ">
                                            <a href="../articles/65.html">
                                                    【某易云逆向】滑动验证码识别篇
                                            </a>
                                        </div>
                                        <div class="item1 ">
                                            <a href="../articles/66.html">
                                                    关于nodejs使用相对路径读取文件的问题
                                            </a>
                                        </div>
                                        <div class="item1 ">
                                            <a href="../articles/55.html">
                                                    解耦在js中的应用
                                            </a>
                                        </div>
                                        <div class="item1 ">
                                            <a href="../articles/22.html">
                                                    为静态站点添加搜索功能
                                            </a>
                                        </div>
                                        <div class="item1 ">
                                            <a href="../articles/19.html">
                                                    为vue单页面应用添加提示保存功能
                                            </a>
                                        </div>
                                        <div class="item1 ">
                                            <a href="../articles/15.html">
                                                    兼容部署在Github Pages与其他服务器的应用引入资源的解决方案
                                            </a>
                                        </div>
                                </div>
                            </div>
                        </div>
                </div>
            </div>
        </div>
    </div>
    </div>
    <div id="main">
        <div class="container mg-0-auto pd-t-10">
            <div class="wrapper">
                <article class="mg-b-20">
                    <div class="markdown-body">
                        <div class="title">我写的脚本竟被官方针对了？！</div>
                        <div class="item meta mg-b-10">
                            <span class="author">由<a href="javascript:void(0);">errol</a>发表于<a href="#">2025-11-08</a></span>
                            <span>|</span>
                            <span class="time">
                            分类为
                            <a href="../categories/6.html">随说</a></span>
                            <span>|</span>
                            <span class="tags">
                                标签为<a href="javascript:void(0);">油猴脚本</a>、<a href="javascript:void(0);">js</a>、<a href="javascript:void(0);">逆向</a>
                            </span>
                        </div>
                            <div class="cover mg-b-10">
                                <img src="../image/portal/202511/ff6d0114f9094eafb75cec4d665dafba-tm.png?project=easyblog" alt="">
                            </div>
                        <div class="content">
                            <p>前段时间，为某网站写了个油猴脚本，并发布到Greasy Fork上...</p>
<p>主要是因为网站的广告特别恶心，满屏广告不说，想下载个东西的时候，点击了，不仅没能打开正确的链接，还总是跳出新的广告，并且是个不断循环的过程，用户压根没有下载的机会，只能当个无情的刷广告机器。</p>
<blockquote>
<p>想关闭更是异想天开</p>
</blockquote>
<p>使用体验就像下面这位一样：</p>
<p><img src="../image/portal/loading.gif" alt="image" data-src="../image/portal/202511/ff41afab69f54f7aa0928161645aeb21-CC56E1B93FC9604BADA1D6CC53E4F38C.png?project=easyblog" /></p>
<p>图1 牛皮癣广告</p>
<p>比较有意思的是，官方把这种情况定性为&quot;误触&quot;，为此，他们还设计了个叫&quot;误触卡&quot;的东西，来避免广告误触，笑了。</p>
<p>且这东西只能通过在app做任务限量获取，虽然没用过，但不难想象，手段肯定是看广告，未来可能还会有付费的方式。</p>
<p>网站本身不提供下载功能，所以都是以外部链接为主，运作机制比较简单，资源页提供了&quot;下载链接&quot;，点击后跳转到广告页，里面才显示真的下载链接，像是百度云、夸克、MEGA之类的。</p>
<p>但是，恶心的地方就在这里，<strong>无论点广告页的哪里，都会继续跳广告，并且还可能触发无限循环，而没法拿到真下载链接。</strong></p>
<p>所以，我才写了这个脚本...</p>
<p>事实上也没花多少功夫，只是稍微调试了网站，发现资源页里的&quot;下载链接&quot;，其实已经包含真的下载链接，只不过经加密了而已，通过逆向得到加密算法后，真下载链接也自然而然到手了。</p>
<p><img src="../image/portal/loading.gif" alt="image" data-src="../image/portal/202511/306c60ff8ea44f1397e280b8222b8b13-615FA9BFA68DB6A7BE500362FFAC41F9.png?project=easyblog" /></p>
<p>图2 在原链接旁提供【复制】功能</p>
<p><strong>这就是脚本的主要功能：绕过广告页，获取资源下载链接。</strong></p>
<p>从发布到现在，运行得挺好的，直到几天前，有人反馈说脚本用不了了...</p>
<p>开始以为是网站的正常迭代更新，但是，当我发现，脚本添加的节点被隐藏的时候，有点绷不住了。。</p>
<blockquote>
<p>display: none;</p>
</blockquote>
<p><strong>原来是刻意针对，精准打补丁。</strong></p>
<p>最初我还纳闷自己什么时候写了这种样式，对代码从头到尾检查了一遍也没发现，愣了一会儿才醒悟。</p>
<p><strong>原因我多少有点眉目，无非与利益相关，网站的主要收益来源于广告，使用脚本=少人看广告=少收益。</strong></p>
<p>看广告可以，但体验疑似确实有点太过于恶心了。</p>
<p>虽然也没几个人用：</p>
<p><img src="../image/portal/loading.gif" alt="image" data-src="../image/portal/202511/70ee23397d8e4f20b30e0cb9956d0e87-D7AEBB86EF4E9DA3ED3DC6EF3A03C166.png?project=easyblog" /></p>
<p>图3 脚本下载量</p>
<p>只是有点惊讶，官方竟然会精准打击脚本，甚至这种聊胜于无的也没放过，写了那么多这还是头一回。</p>
<p>今天做最后一次代码更新，如果后续再被针对性打补丁时，可能就不再发布到Greasy Fork上了，改起来是简单，但也是白写，还伴随风险。</p>
<p>没办法。</p>
<p>----- 20251112</p>
<p>脚本刚改没几天，官方又又更新，理所当然地，脚本也又失效了。</p>
<p>说实话，这反而有点激起我的好胜心了，原本只打算到上一次为止的。有点攻防战的感觉，只不过，双方都是明文操作，照着对方的代码写代码罢。</p>
<p>但其实没什么意义，更新不是增加逆向难度，而是纯粹前端层面的操作，比方说，隐藏了一下节点、属性、改一下类名称，或者重新渲染页面，把脚本添加的节点刷掉这样的，加密还是原来的加密，没动过。</p>
<p>就是为了适配原本的用法，有点麻烦，合适的锚点不好找，每一次，对方都会&quot;精准&quot;地把我的配置弄没，真笑了。</p>
<p>再玩玩，当做锻炼临场逆向能力的练习，这一期，我加入了xhr hook来绕过数据隐藏（原本是直接放在dom节点上，可直接获取）。</p>
<p><img src="../image/portal/loading.gif" alt="image" data-src="../image/portal/202511/736609e11cee46e6b3ce2c9997fad005-F8C992F2AE748725081D1D74596DCEBC.png?project=easyblog" /></p>
<p>图4 v1.2.4</p>
<p>倒想看看，对面还会出些什么样的招数。</p>
<p>----- 20251114</p>
<p>没意思，本来还以为可以再对抗久一点。</p>
<p>连发邮件要我下架脚本，有种像是打小报告的感觉，从技术的角度来说。。确实是有点玩不起了。</p>
<p><img src="../image/portal/loading.gif" alt="image" data-src="../image/portal/202511/ae42739b6711474b94a9430ae9f317e2-106E57DB1F6F6F07FC6D4A293B8F4CAC.png?project=easyblog" /></p>
<p>图5 官方邮件</p>
<p>大致上说，脚本解析了网站前端架构，获取了核心秘钥，涉及到整个平台安全问题之类的，请求下架脚本，不要公开传播。</p>
<p>尽管对方是个违规内容的搬运站，国内没有备案，说到这个份上了多少还是得尊重，咱也不想麻烦上身。</p>
<p>本来就靠牛皮癣广告吃饭，而这个脚本虽然不能说致残，但造成的损伤也不算小。</p>
<p>话又说回来，如果能被这样一个小脚本阻断财路的话，是不是该说这个网站本来就很有问题？</p>
<p>只能苦了用户，再多挂一会就下架，也不知道有几个能更新上最新代码。</p>
<p>不是不想，而是不能，就这样。</p>

                        </div>
                    </div>
                </article>
                <div class="comment-wrap">
                        <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
  <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
                        <div id="gitalk-container"></div>
                        <script>
                            const gitalk = new Gitalk({
                                clientID: 'ae1422e500a8b19fb1fc',
                                clientSecret: '9f387db6a84a4945cdf5dc743c16ce25fdef6b76',
                                repo: 'github-pages',      // The repository of store comments,
                                owner: 'errr0l',
                                admin: ['errr0l'],
                                id: location.pathname,      // Ensure uniqueness and length less than 50
                                distractionFreeMode: false  // Facebook-like distraction free mode
                            });
                            gitalk.render('gitalk-container');
                        </script>
                </div>
            </div>
        </div>
    </div>
    <div class="back">返回</div>
</div>
    <script src="../js/data.js"></script>
    <script src="../js/lazy.js"></script>
    <script src="../js/search.js"></script>
    <script src="../js/menu.js"></script>
<script src="../js/toc.js"></script>
<script src="../js/caption-setter.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/viewerjs/1.11.7/viewer.min.js"></script>
<script>
    let back = document.querySelector(".back");
    back.addEventListener("click", function () {
        window.history.go(-1);
    });
    const viewer = new Viewer(document.querySelector('.markdown-body .content'), {
        toolbar: {
            zoomIn: 4,
            zoomOut: 4,
            oneToOne: 4,
            reset: 0,
            prev: 4,
            play: 0,
            next: 4,
            rotateLeft: 0,
            rotateRight: 0,
            flipHorizontal: 0,
            flipVertical: 0,
        },
    });
</script>
</body>
</html>